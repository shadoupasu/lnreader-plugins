var e=this&&this.__awaiter||function(e,t,l,a){return new(l||(l=Promise))((function(r,n){function o(e){try{i(a.next(e))}catch(e){n(e)}}function u(e){try{i(a.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(o,u)}i((a=a.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var l,a,r,n={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=u(0),o.throw=u(1),o.return=u(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(i){return function(u){if(l)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(l=1,a&&(r=2&u[0]?a.return:u[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,u[1])).done)return r;switch(a=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,a=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(!(r=n.trys,(r=r.length>0&&r[r.length-1])||6!==u[0]&&2!==u[0])){n=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){n.label=u[1];break}if(6===u[0]&&n.label<r[1]){n.label=r[1],r=u;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(u);break}r[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(e){u=[6,e],a=0}finally{l=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,i])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var a=require("@libs/fetch"),r=require("@libs/novelStatus"),n=l(require("dayjs")),o={"User-Agent":"RuLateApp Android","accept-encoding":"gzip"},u=new(function(){function l(e){var t=this;this.resolveUrl=function(e,l){return t.site+"/book/"+e+(l?"/":"/ready_new")},this.id=e.id,this.name=e.sourceName+" (API)",this.icon="multisrc/rulate/".concat(e.id.toLowerCase(),"/icon.png"),this.site=e.sourceSite,this.version="1.0."+(0+e.versionIncrements),this.filters=e.filters,this.key=e.key}return l.prototype.parseNovels=function(e){return(0,a.fetchApi)(e,{headers:o}).then((function(e){return e.json()})).then((function(e){var t,l=[];return"success"===e.status&&(null===(t=e.response)||void 0===t?void 0:t.length)&&e.response.forEach((function(e){return l.push({name:e.t_title||e.s_title,path:e.id.toString(),cover:e.img})})),l}))},l.prototype.popularNovels=function(l,a){return e(this,arguments,void 0,(function(e,l){var a,r,n=l.filters,o=l.showLatestNovels;return t(this,(function(t){return a=this.site+"/api3/searchBooks?limit=40&page="+e,a+="&sort="+(o?"4":(null===(r=null==n?void 0:n.sort)||void 0===r?void 0:r.value)||"6"),Object.entries(n||{}).forEach((function(e){var t=e[0],l=e[1].value;l instanceof Array&&l.length&&(a+="&"+l.map((function(e){return t+"[]="+e})).join("&"))})),a+="&key="+this.key,[2,this.parseNovels(a)]}))}))},l.prototype.searchNovels=function(l){return e(this,arguments,void 0,(function(e,l){var a;return void 0===l&&(l=1),t(this,(function(t){return a="".concat(this.site,"/api3/searchBooks?t=").concat(encodeURIComponent(e),"&limit=40&page=").concat(l,"&key=").concat(this.key),[2,this.parseNovels(a)]}))}))},l.prototype.parseNovel=function(l){return e(this,void 0,void 0,(function(){var e,u,i,s;return t(this,(function(t){switch(t.label){case 0:return[4,(0,a.fetchApi)(this.site+"/api3/book?book_id="+l+"&key="+this.key,{headers:o}).then((function(e){return e.json()}))];case 1:return e=t.sent(),u={name:e.response.t_title||e.response.s_title,path:l,cover:e.response.img,genres:[e.response.genres,e.response.tags].flatMap((function(e){var t;return null===(t=null==e?void 0:e.map)||void 0===t?void 0:t.call(e,(function(e){return e.title||e.name}))})).join(","),summary:e.response.description,author:e.response.author,status:"–ó–∞–≤–µ—Ä—à—ë–Ω"===e.response.status?r.NovelStatus.Completed:r.NovelStatus.Ongoing,rating:e.response.rate&&e.response.rate.count>0?Number((e.response.rate.sum/e.response.rate.count).toFixed(2)):void 0},[4,(0,a.fetchApi)(this.site+"/api3/bookChapters?book_id="+l+"&key="+this.key,{headers:o}).then((function(e){return e.json()}))];case 2:return i=t.sent(),s=[],i.response&&Array.isArray(i.response)&&i.response.forEach((function(e){e.can_read&&0===e.subscription&&s.push({name:e.title+(e.illustrated?" üñºÔ∏è":""),path:l+"/"+e.id,releaseTime:(0,n.default)(1e3*e.cdate).format("LLL"),chapterNumber:e.ord})})),u.chapters=s,[2,u]}}))}))},l.prototype.parseChapter=function(l){return e(this,void 0,void 0,(function(){var e,r,n;return t(this,(function(t){switch(t.label){case 0:return e=l.split("/"),r=e[0],n=e[1],[4,(0,a.fetchApi)(this.site+"/api3/chapter?book_id="+r+"&chapter_id="+n+"&key="+this.key,{headers:o}).then((function(e){return e.json()}))];case 1:return[2,t.sent().response.text]}}))}))},l}())({id:"rulate-api",sourceSite:"https://tl.rulate.ru",sourceName:"Rulate",versionIncrements:0,key:"fpoiKLUues81werht039",filters:{sort:{label:"–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:",value:"6",options:[{label:"–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É",value:"6"},{label:"–ü–æ –¥–∞—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",value:"4"},{label:"–ü–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è",value:"3"},{label:"–ü–æ –∫–æ–ª-–≤—É –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –≥–ª–∞–≤",value:"11"},{label:"–ü–æ –∫–æ–ª-–≤—É –≤ –∑–∞–∫–ª–∞–¥–∫–∞—Ö",value:"13"},{label:"–ü–æ –∫–æ–ª-–≤—É –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º",value:"14"},{label:"–ü–æ –∫–æ–ª-–≤—É –ª–∞–π–∫–æ–≤",value:"8"},{label:"–ü–æ –∫–æ–ª-–≤—É –ø–µ—Ä–µ–≤–µ–¥—ë–Ω–Ω—ã—Ö –≥–ª–∞–≤",value:"7"},{label:"–ü–æ –∫–æ–ª-–≤—É —Ä–µ—Ü–µ–Ω–∑–∏–π",value:"12"},{label:"–ü–æ –∫–æ–ª-–≤—É —Å—Ç—Ä–∞–Ω–∏—Ü",value:"10"},{label:"–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é –Ω–∞ —è–∑—ã–∫–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞",value:"1"},{label:"–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é –Ω–∞ —è–∑—ã–∫–µ –ø–µ—Ä–µ–≤–æ–¥–∞",value:"2"},{label:"–ü–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º",value:"5"},{label:"–ü–æ —Å—Ç–µ–ø–µ–Ω–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏",value:"0"},{label:"–°–ª—É—á–∞–π–Ω–æ",value:"9"}],type:"Picker"},genres:{type:"Checkbox",label:"–ñ–∞–Ω—Ä—ã: –≤—Å–µ –∂–∞–Ω—Ä—ã –ª—é–±–æ–π –∂–∞–Ω—Ä",value:"",options:[{label:"18+",value:"52"},{label:"21+",value:"59"},{label:"–∞—Ä—Ç",value:"1"},{label:"–±–æ–µ–≤–∏–∫",value:"2"},{label:"–±–æ–µ–≤—ã–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞",value:"3"},{label:"–≥–∞—Ä–µ–º–Ω–∏–∫",value:"5"},{label:"–≥–µ—Ä–æ–∏—á–µ—Å–∫–æ–µ —Ñ—ç–Ω—Ç–µ–∑–∏",value:"7"},{label:"–≥–æ—Ä–æ–¥—Å–∫–æ–µ —Ñ—ç–Ω—Ç–µ–∑–∏",value:"57"},{label:"–¥–µ—Ç–µ–∫—Ç–∏–≤",value:"8"},{label:"–¥–∑—ë—Å—ç–π",value:"9"},{label:"–¥–æ–¥–∑–∏–Ω—Å–∏",value:"10"},{label:"–¥—Ä–∞–º–∞",value:"11"},{label:"–∏—Å—Ç–æ—Ä–∏—è",value:"13"},{label:"–∫–∏–±–µ—Ä–ø–∞–Ω–∫",value:"46"},{label:"–∫–æ–¥–æ–º–æ",value:"14"},{label:"–∫–æ–º–µ–¥–∏—è",value:"15"},{label:"–ª–∏—Ç—Ä–ø–≥",value:"48"},{label:"–º–∞—Ö–æ-—Å—ë–¥–∑—ë",value:"16"},{label:"–º–µ–ª–æ–¥—Ä–∞–º–∞",value:"49"},{label:"–º–µ—Ö–∞",value:"17"},{label:"–º–∏—Å—Ç–∏–∫–∞",value:"18"},{label:"–Ω–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞",value:"19"},{label:"–ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç—å",value:"20"},{label:"–ø–æ—Å—Ç–∞–ø–æ–∫–∞–ª–∏–ø—Ç–∏–∫–∞",value:"21"},{label:"–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è",value:"22"},{label:"–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è",value:"23"},{label:"—Ä–æ–º–∞–Ω—Ç–∏–∫–∞",value:"24"},{label:"—Å–∞–º—É—Ä–∞–π—Å–∫–∏–π –±–æ–µ–≤–∏–∫",value:"25"},{label:"—Å–≤–µ—Ä—Ö—ä–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ",value:"26"},{label:"—Å—ë–¥–∑—ë",value:"27"},{label:"—Å—ë–Ω—ç–Ω",value:"29"},{label:"—Å–º–∞—Ç",value:"45"},{label:"—Å–ø–æ—Ä—Ç",value:"31"},{label:"—Å—ç–π–Ω—ç–Ω",value:"32"},{label:"—Å—é–∞–Ω—å—Ö—É–∞",value:"44"},{label:"—Å—é–∞–Ω—å—Ö—É–∞–Ω—å",value:"47"},{label:"—Å—è–Ω—å—Å—è (XianXia)",value:"42"},{label:"—Ç—Ä–∞–≥–µ–¥–∏—è",value:"33"},{label:"—Ç—Ä–∏–ª–ª–µ—Ä",value:"34"},{label:"—É–∂–∞—Å—ã",value:"35"},{label:"—É—Å—è (wuxia)",value:"41"},{label:"—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞",value:"36"},{label:"—Ñ–∞–Ω—Ñ–∏–∫",value:"50"},{label:"—Ñ—ç–Ω—Ç–µ–∑–∏",value:"37"},{label:"—à–∫–æ–ª–∞",value:"38"},{label:"—ç—Ç—Ç–∏",value:"39"}]}}});exports.default=u;